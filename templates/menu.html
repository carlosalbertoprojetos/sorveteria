{% extends 'base.html' %}
{% block title %}Pagina 1{% endblock %}
{% block content %}
<h2 class="pb-2 border-bottom">Cardápio</h2>
<p>Selecione o recipiente para montar seu sorvete. A quantidade de bolas de sorvete pode variar, e você pode escolher
    diferentes sabores.</p>
<div class="row row-cols-1 row-cols-lg-4 align-items-stretch g-4 py-5">
    {% for emb in embalagens %}
    <div class="col">
        <a href="" class="link-dark text-decoration-none" data-bs-toggle="modal" data-bs-target="#sabores_{{emb.id}}">
            <div class="card border-0" style="height: 250px; background-size: cover; 
			background-image: url('https://http2.mlstatic.com/D_NQ_NP_917685-MLB49794642888_042022-O.webp');">
                <div class="d-flex flex-column h-100 p-5 pb-3 text-white text-shadow-1">
                    <ul class="d-flex list-unstyled mt-auto text-dark">
                        <li class="d-flex align-items-center me-3">
                            <h1>{{emb.tipo}}</h1>
                        </li>
                        <li class="d-flex align-items-center">
                            <svg class="bi me-2" width="1em" height="1em">
                                <use xlink:href="#calendar3"></use>
                            </svg>
                            <h6>{{emb.capacidade_maxima_bolas}} Bolas</h6>
                        </li>
                    </ul>
                </div>
            </div>
        </a>
    </div>
    {% include 'sabores.html' %}
    {% endfor %}
</div>
{% endblock %}

{% block scripts %}

<script>
    $(document).ready(function () {
        $('.count').prop('disabled', true);

        function atualizarTotalSelecionado() {
            var totalSelecionado = 0;
            $('.count').each(function () {
                totalSelecionado += parseInt($(this).val());
            });
            $('#resultselsabor').text(totalSelecionado);
        }

        $(document).on('click', '.plus', function () {
            var input = $(this).siblings('input.count');
            var saborId = input.data('saborid');
            var input_max = $(this).parent().find('input.selsabor');
            var capacidadeMaxima = input_max.data('capmax');
            var totalSelecionado = 0;

            // Calcular o total selecionado para todos os sabores
            $('.count').each(function () {
                totalSelecionado += parseInt($(this).val());
            });

            if ((totalSelecionado + 1) <= capacidadeMaxima) {
                input.val(parseInt(input.val()) + 1);
            }

            // Atualizar o totalSelecionado após a adição
            atualizarTotalSelecionado();
        });

        $(document).on('click', '.minus', function () {
            var input = $(this).siblings('input.count');
            var saborId = input.data('saborid');
            input.val(parseInt(input.val()) - 1);
            if (input.val() < 0) {
                input.val(0);
            }

            // Atualizar o totalSelecionado após a subtração
            atualizarTotalSelecionado();
        });
    });
</script>

{% endblock scripts %}